% !TEX encoding = UTF-8 Unicode
%
% =========================================================
%  is-thesis.sty
%  東京都立産業技術高等専門学校 情報システム工学コース 卒業研究用スタイル
% =========================================================
\typeout{2025-12-03 TMCIT IS thesis style v1.0.2}
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{is-thesis}[2025/11/28 v1.9 IS graduation thesis style]

% -------------------------
% 必要パッケージ
% -------------------------
\RequirePackage[a4paper,margin=20mm]{geometry}
\RequirePackage{setspace}
\RequirePackage{fancyhdr}
\RequirePackage{titlesec}
\RequirePackage{caption}
\RequirePackage{graphicx}
\RequirePackage{amsmath,amssymb}
\RequirePackage{url}
\RequirePackage{hyperref}
\RequirePackage{indentfirst}

\hypersetup{
  colorlinks=true,
  linkcolor=black,
  citecolor=black,
  urlcolor=black
}

% -------------------------
% 行間・行頭字下げ
% -------------------------
\doublespacing
\setlength{\parindent}{1em}

% -------------------------
% ページスタイル（ヘッダ無し）
% -------------------------
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancyhf{}
\fancyhead{}
\fancyfoot[C]{\thepage}
\setlength{\headheight}{12pt}

% ----------------------------------------------------------
% メタ情報コマンド
% ----------------------------------------------------------
\newcommand{\thesistitle}{}
\newcommand{\thesissubtitle}{}
\newcommand{\thesisauthor}{}
\newcommand{\thesisdate}{\today}

\newcommand{\thesisdepartment}{東京都立産業技術高等専門学校}
\newcommand{\thesismajor}{ものづくり工学科}  % ← ★ 追加
\newcommand{\thesiscourse}{情報システム工学コース}

\newcommand{\titleJP}[1]{\renewcommand{\thesistitle}{#1}}
\newcommand{\subtitleJP}[1]{\renewcommand{\thesissubtitle}{#1}}
\newcommand{\authorJP}[1]{\renewcommand{\thesisauthor}{#1}}
\newcommand{\thesisDate}[1]{\renewcommand{\thesisdate}{#1}}

% ----------------------------------------------------------
% 表紙（氏名のみ表示）
% ----------------------------------------------------------
\makeatletter
\newcommand{\makethesistitlepage}{%
  \thispagestyle{empty}%
  \begin{center}
    \vspace*{20mm}

    % 学校名
    {\Large \thesisdepartment \par}
    %\vspace{2mm}

%    % ものづくり工学科（★ 追加行）
%    {\Large \thesismajor \par}
%    % コース名
%    {\Large \thesiscourse \par}

    {\Large \thesismajor \hspace{1zw} \thesiscourse \par}

    %\vspace{2mm}
    {\Large 卒業研究論文 \par}

%    \vspace{25mm}
    \vfill
    {\LARGE \thesistitle \par}

    \ifx\thesissubtitle\@empty\else
      \vspace{4mm}
      {\Large \thesissubtitle \par}
    \fi

    \vfill
    % 氏名のみ
    \begin{tabular}{c}
      \LARGE \thesisauthor \\
    \end{tabular}

    \vfill
    \vfill
    {\Large \thesisdate \par}
    \vspace{15mm}

    \vfill
    \vfill
    \null

  \end{center}
  \clearpage
}
\makeatother

% ----------------------------------------------------------
% 見出しデザイン
% ----------------------------------------------------------
\titleformat{\chapter}{\normalfont\huge\bfseries}{\thechapter}{1em}{}
\titlespacing*{\chapter}{0pt}{-0.5\baselineskip}{1.5\baselineskip}

\titleformat{\section}{\normalfont\Large\bfseries}{\thesection}{0.8em}{}
\titleformat{\subsection}{\normalfont\large\bfseries}{\thesubsection}{0.8em}{}

% ----------------------------------------------------------
% 図表キャプション
% ----------------------------------------------------------
\captionsetup[figure]{labelsep=space,font=small}
\captionsetup[table]{labelsep=space,font=small}

% ----------------------------------------------------------
% 謝辞
% ----------------------------------------------------------
\newenvironment{acknowledgements}{%
  \chapter*{謝辞}%
  \addcontentsline{toc}{chapter}{謝辞}%
}{\clearpage}

% ----------------------------------------------------------
% 目次など
% ----------------------------------------------------------
\newcommand{\makethesistoc}{%
  \tableofcontents
  \clearpage
  \listoffigures
  \clearpage
  \listoftables
  \clearpage
}

% ----------------------------------------------------------
% ページ番号切替
% ----------------------------------------------------------
\newcommand{\beginfrontmatter}{%
  \pagenumbering{roman}%
  \setcounter{page}{1}%
}

\newcommand{\beginmainmatter}{%
  \clearpage
  \pagenumbering{arabic}%
  \setcounter{page}{1}%
}

% ----------------------------------------------------------
% パッケージ終わり
% ----------------------------------------------------------
\endinput
